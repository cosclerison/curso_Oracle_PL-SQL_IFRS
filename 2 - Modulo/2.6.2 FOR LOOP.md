## 2.6.2 FOR LOOP
O comando FOR LOOP pode ser utilizado ao invés dos comandos OPEN, FETCH e CLOSE. Na verdade o FOR LOOP executa as 3 operações de forma implícita simplificando o código.

<Exemplo1>: Criar um bloco PL/SQL anônimo para recuperar o nome e o salário de todos os funcionários do departamento 1.

DECLARE
CURSOR c_funcionario IS
SELECT nome_funcionario,salario
FROM funcionario f
WHERE f.id_departamento =1;
BEGIN
/* FOR record_name IN cursor_name */
/* For open,fetch e close implícito */
FOR r_funcionario IN c_funcionario LOOP
DBMS_OUTPUT.PUT_LINE(r_funcionario.nome_funcionario);
DBMS_OUTPUT.PUT_LINE(r_funcionario.salario);
END LOOP; 
END;

/*  */ é comentário

Explicando o código:
O cursor é declarado em CURSOR com o nome c_funcionario.
No bloco principal do bloco PL/SQL o comando FOR LOOP é utilizado. r_funcionario é uma declaração implícita de uma variável registro que vai conter todos os campos da cláusula SELECT, neste caso nome_funcionario e salario. No comando FOR o IN c_funcionario é o nome do nosso CURSOR. É possível observar que não são utilizados os comandos OPEN, FETCH e CLOSE pois estas operações são executadas implicitamente pelo comando FOR LOOP. 
Dentro do comando FOR o PUT_LINE imprime o nome do funcionário (r_funcionario.nome_funcionario) e o salário (r_funcionario.salario).

<Exemplo2>: Neste exemplo vamos criar uma procedure que recupera o nome e o salário dos funcionários de um determinado departamento. O id do departamento é determinado por uma variável e o cursor é executado mais de uma vez, uma para cada valor de id_departamento.

CREATE OR REPLACE PROCEDURE consulta_funcionario IS
v_id_departamento NUMBER; -- deve ser declarado antes do cursor
CURSOR c_funcionario IS
SELECT nome_funcionario, salario
FROM Funcionario
WHERE id_departamento = v_id_departamento;
BEGIN
v_id_departamento:=1;
DBMS_OUTPUT.PUT_LINE('Departamento = 1 ');
FOR r_funcionario IN c_funcionario LOOP
DBMS_OUTPUT.PUT_LINE(r_funcionario.nome_funcionario||' '|| r_funcionario.salario); 
END LOOP;
v_id_departamento:=2;
DBMS_OUTPUT.PUT_LINE('Departamento = 2');
FOR r_funcionario IN c_funcionario LOOP 
DBMS_OUTPUT.PUT_LINE(r_funcionario.nome_funcionario||' '|| r_funcionario .salario); 
END LOOP;
 END;﻿

Explicando o código:

 Na declaração do cursor utilizamos a variável v_id_departamento na cláusula WHERE para recuperar os funcionários onde id_departamento é igual ao conteúdo da variável v_id_departamento. 

 A varíável v_id_departamento começa recebendo o valor 1 (v_id_departamento := 1). Quando o primeiro FOR LOOP for executado o SELECT associado ao cursor será executado para os fucionários do departamento 1.

  Depois que o cursor é executado para o departamento 1 a variável v_id_deptarmento recebe o valor 2 (v_id_departamento :=2) e o cursor é executado novamente (segundo FOR LOOP) agora para o departamento 2.

<Exemplo3>: Neste exemplo criamos um bloco PL/SQL anônimo para recuperar os dados de todos os funcionários. Não foi feita a declaração do cursor na seção DECLARE pois o SELECT foi colocado dentro do comando FOR LOOP. Esta estrutura não é recomenda se o a consulta for mais complexa pois o código pode ficar confuso com uma consulta muito grande no comando FOR LOOP.
A seção DECLARE não foi utilizada no bloco PL/SQL pois não temos nenhuma variável neste bloco PL/SQL.


BEGIN
FOR r_funcionario IN (SELECT * FROM funcionario) LOOP
DBMS_OUTPUT.PUT_LINE(r_funcionario.nome_funcionario||' '|| r_funcionario .salario); 
END LOOP;
END;